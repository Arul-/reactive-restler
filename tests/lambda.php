<?php declare(strict_types=1);


use Lambda\Convert;
use Luracast\Restler\Utils\Dump;

include __DIR__ . "/../vendor/autoload.php";

$data = '{"invocationId":"e674bc8a-3b3b-4ecb-b9b3-62a61d72750a","headers":{"content-type":"application\/json","lambda-runtime-aws-request-id":"e674bc8a-3b3b-4ecb-b9b3-62a61d72750a","lambda-runtime-deadline-ms":"1585481056997","lambda-runtime-invoked-function-arn":"arn:aws:lambda:ap-southeast-1:787614641643:function:echo","lambda-runtime-trace-id":"Root=1-5e80855d-1b1bfe607907eb3011e7c030;Parent=748bb6e80f95450c;Sampled=0","date":"Sun, 29 Mar 2020 11:24:13 GMT","transfer-encoding":"chunked"},"statusCode":200,"requestBody":{"resource":"\/{proxy+}","path":"\/glucode\/param\/1","httpMethod":"GET","headers":{"accept":"text\/html,application\/xhtml+xml,application\/xml;q=0.9,image\/webp,image\/apng,*\/*;q=0.8,application\/signed-exchange;v=b3;q=0.9","accept-encoding":"gzip, deflate, br","accept-language":"en-US,en;q=0.9,ta;q=0.8","cache-control":"max-age=0","dnt":"1","Host":"cz7kagh2l9.execute-api.ap-southeast-1.amazonaws.com","sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"none","sec-fetch-user":"?1","upgrade-insecure-requests":"1","User-Agent":"Mozilla\/5.0 (Macintosh; Intel Mac OS X 10_15_3) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/80.0.3987.149 Safari\/537.36","X-Amzn-Trace-Id":"Root=1-5e80855d-1b1bfe607907eb3011e7c030","X-Forwarded-For":"101.127.246.210","X-Forwarded-Port":"443","X-Forwarded-Proto":"https"},"multiValueHeaders":{"accept":["text\/html,application\/xhtml+xml,application\/xml;q=0.9,image\/webp,image\/apng,*\/*;q=0.8,application\/signed-exchange;v=b3;q=0.9"],"accept-encoding":["gzip, deflate, br"],"accept-language":["en-US,en;q=0.9,ta;q=0.8"],"cache-control":["max-age=0"],"dnt":["1"],"Host":["cz7kagh2l9.execute-api.ap-southeast-1.amazonaws.com"],"sec-fetch-dest":["document"],"sec-fetch-mode":["navigate"],"sec-fetch-site":["none"],"sec-fetch-user":["?1"],"upgrade-insecure-requests":["1"],"User-Agent":["Mozilla\/5.0 (Macintosh; Intel Mac OS X 10_15_3) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/80.0.3987.149 Safari\/537.36"],"X-Amzn-Trace-Id":["Root=1-5e80855d-1b1bfe607907eb3011e7c030"],"X-Forwarded-For":["101.127.246.210"],"X-Forwarded-Port":["443"],"X-Forwarded-Proto":["https"]},"queryStringParameters":{"test":"two"},"multiValueQueryStringParameters":{"test":["one","two"]},"pathParameters":{"proxy":"glucode\/param\/1"},"stageVariables":null,"requestContext":{"resourceId":"fcp6zj","resourcePath":"\/{proxy+}","httpMethod":"GET","extendedRequestId":"KJnGsHxWyQ0Fqxw=","requestTime":"29\/Mar\/2020:11:24:13 +0000","path":"\/dev\/glucode\/param\/1","accountId":"787614641643","protocol":"HTTP\/1.1","stage":"dev","domainPrefix":"cz7kagh2l9","requestTimeEpoch":1585481053983,"requestId":"c8b73408-996e-4fb5-b400-c92cf09da763","identity":{"cognitoIdentityPoolId":null,"accountId":null,"cognitoIdentityId":null,"caller":null,"sourceIp":"101.127.246.210","principalOrgId":null,"accessKey":null,"cognitoAuthenticationType":null,"cognitoAuthenticationProvider":null,"userArn":null,"userAgent":"Mozilla\/5.0 (Macintosh; Intel Mac OS X 10_15_3) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/80.0.3987.149 Safari\/537.36","user":null},"domainName":"cz7kagh2l9.execute-api.ap-southeast-1.amazonaws.com","apiId":"cz7kagh2l9"},"body":null,"isBase64Encoded":false},"environment":{"PATH":"\/usr\/local\/bin:\/usr\/bin\/:\/bin:\/opt\/bin","LD_LIBRARY_PATH":"\/lib64:\/usr\/lib64:\/var\/runtime:\/var\/runtime\/lib:\/var\/task:\/var\/task\/lib:\/opt\/lib","LANG":"en_US.UTF-8","TZ":":UTC","LAMBDA_TASK_ROOT":"\/var\/task","LAMBDA_RUNTIME_DIR":"\/var\/runtime","AWS_REGION":"ap-southeast-1","AWS_DEFAULT_REGION":"ap-southeast-1","AWS_LAMBDA_LOG_GROUP_NAME":"\/aws\/lambda\/echo","AWS_LAMBDA_LOG_STREAM_NAME":"2020\/03\/29\/[$LATEST]f4a799e3e60e4210abff002f14a9c1bc","AWS_LAMBDA_FUNCTION_NAME":"echo","AWS_LAMBDA_FUNCTION_MEMORY_SIZE":"128","AWS_LAMBDA_FUNCTION_VERSION":"$LATEST","_AWS_XRAY_DAEMON_ADDRESS":"169.254.79.2","_AWS_XRAY_DAEMON_PORT":"2000","AWS_XRAY_DAEMON_ADDRESS":"169.254.79.2:2000","AWS_XRAY_CONTEXT_MISSING":"LOG_ERROR","_HANDLER":"hello","AWS_LAMBDA_RUNTIME_API":"127.0.0.1:9001","AWS_ACCESS_KEY_ID":"ASIA3OYL5VXVRZMOVVHZ","AWS_SECRET_ACCESS_KEY":"xR3Vgqj4Y+0MoVmCJLBGU90JzJK55tJAes4Y+1dx","AWS_SESSION_TOKEN":"IQoJb3JpZ2luX2VjENz\/\/\/\/\/\/\/\/\/\/wEaDmFwLXNvdXRoZWFzdC0xIkYwRAIgIbjEwSLy8QLTwtz41QCCoe81Ao5Upn7t3rALTC94ScMCIEBcvdCgEchUT\/EU5DZTQpxSq1T\/35GLvyEKepCUBlXkKswBCNX\/\/\/\/\/\/\/\/\/\/wEQARoMNzg3NjE0NjQxNjQzIgzVmPBBsYwBmnfloQwqoAFRxvBAhqih8obn7RJnzya8OJvzblV9OOXiWPJQj9m2FFb7c\/Wj5F1wWm3i+xMVOWjpwPhU5S\/4CneA1apqGn2KKgXo1LTBeUJlT2WtaSPc7MFqB9rfaP3vc5kne8+nDOQINhcwsXsoEXzN0bXxtWwwcXofQKDRMm9h5iMQDpIOeMHgHizPltTRl1vqQflPNiMSRWBIBG5Xlt9+aIZ2GxBJMLyKgvQFOuEBhjoQKzbfi9x7d\/jcr87\/+yEhEHRTK3SbptG81z1MzvHduBT4nCoZZusNAMPQuYdTiXhE6V6533GgOXpj6u+6od2w5MSa6GlXyXrjU3HDqFqRsl8aObjkWqdtd0NrBWG9PbVuTzY0s6FW+WVTMKKAvERShpuDnmBiWHiB5X\/WXG9F57VMSe9f3pONNnpme79h9gjiJo0RjcS2XrxghuzHpoS\/ScXdO61jK6gukvg+dT5mUgHmMZVSxhxfAvwjEAzVgIZ3gtj3or\/yuHKl\/cxGiX9hqmBipdEopIP8kDmIJbkr"}}';

$data = json_decode($data, true);

//var_dump($data);

$request = Convert::toPSR7($data['requestBody'], $data['headers']);

echo Dump::request($request);

$response = new \RingCentral\Psr7\Response(201,['ContentType'=>'application/json'],'{}');

var_dump(Convert::fromPSR7($response));

var_dump(get_included_files());
